(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{4380:(e,r,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/products",function(){return t(4609)}])},4609:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var n=t(7876),o=t(4232),s=t(9099),i=t(8230),d=t.n(i),a=t(5375);function l(e){let{product:r}=e,[t,s]=(0,o.useState)(!1),i=async(e,r)=>{try{let t=localStorage.getItem("token"),n=await fetch("https://enxtai-assignment-sub.onrender.com/api/v1/txn/buy",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({productId:e,units:r})});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));return await n.json()}catch(e){throw e}};return(0,n.jsxs)("div",{style:{width:"250px",border:"1px solid #ccc",borderRadius:"10px",padding:"20px",margin:"20px"},children:[(0,n.jsx)("h3",{children:r.name}),(0,n.jsxs)("p",{children:["Category: ",r.category]}),(0,n.jsxs)("p",{children:["Price: ",r.price]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsx)(d(),{href:"/products/".concat(r.id),children:"View Details"}),(0,n.jsx)("button",{style:{backgroundColor:"green",color:"white",padding:"10px",border:"none",borderRadius:"5px"},onClick:()=>s(!0),children:"Buy"})]}),(0,n.jsx)(a.A,{product:r,isOpen:t,onClose:()=>s(!1),onBuy:i})]})}function c(){let e=(0,s.useRouter)(),[r,t]=(0,o.useState)([]),[i,a]=(0,o.useState)(null);return(0,o.useEffect)(()=>{localStorage.getItem("token")?(async()=>{try{let e=await fetch("https://enxtai-assignment-sub.onrender.com/api/v1/products"),r=await e.json();t(r)}catch(e){console.error("Error fetching products:",e),a(e.message)}})():e.push("/login")},[e]),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{position:"absolute",top:"10px",right:"10px"},children:[(0,n.jsx)(d(),{href:"/portfolio",style:{backgroundColor:"transparent",border:"none",padding:"10px",textDecoration:"underline"},children:"View Portfolio"}),(0,n.jsx)("button",{style:{backgroundColor:"transparent",border:"none",padding:"10px",textDecoration:"underline"},onClick:()=>{localStorage.removeItem("token"),e.push("/login")},children:"Logout"})]}),(0,n.jsx)("h2",{children:"Product Listing"}),i?(0,n.jsxs)("p",{children:["Error: ",i]}):(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},children:r.map(e=>(0,n.jsx)(l,{product:e},e.id))})]})}},5375:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});var n=t(7876),o=t(4232);function s(e){let{product:r,isOpen:t,onClose:s,onBuy:i}=e,[d,a]=(0,o.useState)(1),[l,c]=(0,o.useState)(null),[u,p]=(0,o.useState)(null),x=async()=>{if(d<1||d>10)return void p("Units must be between 1 and 10");try{await i(r.id,d),c({success:!0})}catch(e){c({success:!1,message:e.message})}};return t?l?(0,n.jsx)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0px 0px 10px rgba(0,0,0,0.2)",width:"300px",height:"200px",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center"},children:l.success?(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:"Purchase Successful!"}),(0,n.jsx)("button",{style:{backgroundColor:"green",color:"white",padding:"10px",border:"none",borderRadius:"5px"},onClick:s,children:"Okay"})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:"Purchase Failed"}),(0,n.jsxs)("p",{children:["Reason: ",l.message]}),(0,n.jsx)("button",{style:{backgroundColor:"green",color:"white",padding:"10px",border:"none",borderRadius:"5px"},onClick:s,children:"Okay"})]})}):(0,n.jsxs)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"10px",boxShadow:"0px 0px 10px rgba(0,0,0,0.2)",width:"300px",height:"200px",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,n.jsxs)("h2",{children:["Buy ",r.name]}),(0,n.jsxs)("label",{children:["Units:",(0,n.jsx)("input",{type:"number",value:d,onChange:e=>{let r=e.target.valueAsNumber;r>=1&&r<=10?(a(r),p(null)):p("Units must be between 1 and 10")}}),u&&(0,n.jsx)("p",{style:{color:"red"},children:u})]}),(0,n.jsx)("button",{style:{backgroundColor:"green",color:"white",padding:"10px",border:"none",borderRadius:"5px"},onClick:x,children:"Proceed"}),(0,n.jsx)("button",{style:{backgroundColor:"red",color:"white",padding:"10px",border:"none",borderRadius:"5px"},onClick:s,children:"Cancel"})]}):null}},9099:(e,r,t)=>{e.exports=t(6296)}},e=>{e.O(0,[230,636,593,792],()=>e(e.s=4380)),_N_E=e.O()}]);